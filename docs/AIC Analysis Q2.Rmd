---
title: "AIC Analysis Q2"
author: "Elizabeth Max"
output: html_document
---
#Set up
```{r, warning=FALSE, message=FALSE}
rm(list=ls())

#AIC
library(AICcmodavg)
library(plm) #for random factors
library(lme4)
library(car)

#Table 
library(sjPlot) 
library(sjmisc)
library(sjlabelled)
library(insight)
library(tibble)


#extra, just in case
library(tidyverse)
library(ggpubr)
library(scales)
library(chron)
library(plotly)
library(aweek)
library(easypackages)
library(renv)
library(here)
library(ggthemes)
library(gridExtra)
library(patchwork)
library(tidyquant)
library(recipes) 
library(cranlogs)
library(knitr)
library(openair)
library(xts)
library(dplyr)
library(reshape2)
```

Set work drive and upload csv
```{r}
#Set work drive
setwd("C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R")
#upload file
masterfile <- read.csv("masterfile_aic.csv")
```

#All unique combinations for environmental indicies
```{r}
##Get all unique combinations of NPGO, PDO, SOI, CUTI, and BEUTI at one month lag. 
#Can use these lists for 3 month lag too.
#First create the list of variables
lag1.indicies <- c("NPGO.1", "PDO.1", "SOI.1", "CUTI_37.1", "BEUTI_37.1")
##Now get all unique combinations
#all values (5)
combn(unique(lag1.indicies), 5)
#4 values per list
combn(unique(lag1.indicies), 4)
#3 values per list
combn(unique(lag1.indicies), 3)
#2 values per list
combn(unique(lag1.indicies), 2)
#1 value per list
combn(unique(lag1.indicies), 1)
```

#AIC - Q2, all upright, one month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"u" stands for the models used for the "upright" list of species."ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "u3.2.1" is the second list from the 3 values list, with a one month lag.
uind5.1.1 <- lm(upright ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile) 

uind4.1.1 <- lm(upright ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uind4.2.1 <- lm(upright ~ NPGO.1 + PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uind4.3.1 <- lm(upright ~ NPGO.1 + PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uind4.4.1 <- lm(upright ~ NPGO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uind4.5.1 <- lm(upright ~ PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uind3.1.1 <- lm(upright ~ NPGO.1 + PDO.1 + SOI.1, data = masterfile)

uind3.2.1 <- lm(upright ~ NPGO.1 + PDO.1 + CUTI_37.1, data = masterfile)

uind3.3.1 <- lm(upright ~ NPGO.1 + PDO.1 + BEUTI_37.1, data = masterfile)

uind3.4.1 <- lm(upright ~ NPGO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uind3.5.1 <- lm(upright ~ NPGO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uind3.6.1 <- lm(upright ~ NPGO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uind3.7.1 <- lm(upright ~ PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uind3.8.1 <- lm(upright ~ PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uind3.9.1 <- lm(upright ~ PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uind3.10.1 <- lm(upright ~ SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uind2.1.1 <- lm(upright ~ NPGO.1 + PDO.1, data = masterfile)

uind2.2.1 <- lm(upright ~ NPGO.1 + SOI.1, data = masterfile)

uind2.3.1 <- lm(upright ~ NPGO.1 + CUTI_37.1, data = masterfile)

uind2.4.1 <- lm(upright ~ NPGO.1 + BEUTI_37.1, data = masterfile)

uind2.5.1 <- lm(upright ~ PDO.1 + SOI.1, data = masterfile)

uind2.6.1 <- lm(upright ~ PDO.1 + CUTI_37.1, data = masterfile)

uind2.7.1 <- lm(upright ~ PDO.1 + BEUTI_37.1, data = masterfile)

uind2.8.1 <- lm(upright ~ SOI.1 + CUTI_37.1, data = masterfile)

uind2.9.1 <- lm(upright ~ SOI.1 + BEUTI_37.1, data = masterfile)

uind2.10.1 <- lm(upright ~ CUTI_37.1 + BEUTI_37.1, data = masterfile)

uind1.1.1 <- lm(upright ~ NPGO.1, data = masterfile)

uind1.2.1 <- lm(upright ~ PDO.1, data = masterfile)

uind1.3.1 <- lm(upright ~ SOI.1, data = masterfile)

uind1.4.1 <- lm(upright ~ CUTI_37.1, data = masterfile)

uind1.5.1 <- lm(upright ~ BEUTI_37.1, data = masterfile)

#define list of models
uindmodels1 <- list(uind5.1.1, uind4.1.1, uind4.2.1, uind4.3.1, uind4.4.1, uind4.5.1, uind3.1.1, uind3.2.1, uind3.3.1, uind3.4.1, uind3.5.1, uind3.6.1, uind3.7.1, uind3.8.1, uind3.9.1, uind3.10.1, uind2.1.1, uind2.2.1, uind2.3.1, uind2.4.1, uind2.5.1, uind2.6.1, uind2.7.1, uind2.8.1, uind2.9.1, uind2.10.1, uind1.1.1, uind1.2.1, uind1.3.1, uind1.4.1, uind1.5.1)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
uindmod1.names <- c('NPGO + PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI + CUTI', 'NPGO + PDO + SOI + BEUTI', 'NPGO + PDO + CUTI + BEUTI', 'NPGO + SOI + CUTI + BEUTI', 'PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI', 'NPGO + PDO + CUTI', 'NPGO + PDO + BEUTI', 'NPGO + SOI + CUTI', 'NPGO + SOI + BEUTI', 'NPGO + CUTI + BEUTI', 'PDO + SOI + CUTI', 'PDO + SOI + BEUTI', 'PDO + CUTI + BEUTI', 'SOI + CUTI + BEUTI', 'NPGO + PDO', 'NPGO + SOI', 'NPGO + CUTI', 'NPGO + BEUTI', 'PDO + SOI', 'PDO + CUTI', 'PDO + BEUTI', 'SOI + CUTI', 'SOI + BEUTI', 'CUTI + BEUTI', 'NPGO', 'PDO', 'SOI', 'CUTI', 'BEUTI')

#calculate AIC of each model
uindmodel1_aic <- aictab(cand.set = uindmodels1, modnames = uindmod1.names)

#Remove unnecessary column
uindmodel1_aic <- select(uindmodel1_aic, -ModelLik)

#Move LL column (log-likelihood) to end
uindmodel1_aic <- uindmodel1_aic %>% relocate (LL, .after = Cum.Wt)
```

Save AIC results as a CSV
```{r}
write.csv(uindmodel1_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/uindmodel1_aic.csv", row.names = TRUE)
```

Make a nice table of Upright model AIC rank results
```{r}
uindmodel1_table <-
  tab_df(uindmodel1_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - all upright species. Climate indices lagged 1 month.", 
         col.header = c( #Default headers are okay, these are better
            "Model",
            "K",
            "AIC",
            "Delta AIC",
            "AIC Wt",
            "Cum. Wt",
            "LL"
            ),
         CSS = list( #Use CSS to modify table appearance
           css.footnote = 'text-align: left; '
         ),
         footnote = "<i>K</i> = multiplier penalty term depending on the number of terms in the model.<br/>
          <i>AIC</i> = Aikaki Information Criterion (AIC); models with lower AIC values contain more information.<br/>
         <i>Delta AIC</i> = Change in AIC value from top ranked model.<br/>
         <i>AIC Wt</i> = weight of evidence for given model.</br>
         <i>Cum.Wt</i> = cumulative AIC weight.</br>
         <i>LL</i> = log-likelihood of given model.",
         show.footnote = TRUE)

print(uindmodel1_table)
```

Model uind4.4.1 is ranked the highest.
uind4.4.1 <- lm(upright ~ NPGO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(uind4.4.1)
```
```{r}
uind4.4.1
```
```{r}
summary(uind4.4.1)
```

```{r}
anova(uind4.4.1)
```

```{r}
confint(uind4.4.1)
```
uind4.4.1 <- lm(upright ~ NPGO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)
Table of model uind4.4.1 with standard error
```{r, echo=FALSE}
top_uindmodel1 <-
  tab_model(uind4.4.1,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Top ranked linear model for large-scale ocean-climate patterns on cover of all upright species.",
  linebreak = TRUE,
  dv.labels = c("Cover"),
  #define row labels
  pred.labels = c(
    "Intercept",
    "NPGO",
    "SOI",
    "CUTI",
    "BEUTI"),
  CSS = css_theme("cells")
  )

#See table in viewer
print(top_uindmodel1)
```

#AIC - Q2, all upright, three month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"u" stands for the models used for the "upright" list of species."ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "u3.2.3" is the second list from the 3 values list, with a three month lag.
uind5.1.3 <- lm(upright ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind4.1.3 <- lm(upright ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uind4.2.3 <- lm(upright ~ NPGO.3 + PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uind4.3.3 <- lm(upright ~ NPGO.3 + PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind4.4.3 <- lm(upright ~ NPGO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind4.5.3 <- lm(upright ~ PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind3.1.3 <- lm(upright ~ NPGO.3 + PDO.3 + SOI.3, data = masterfile)

uind3.2.3 <- lm(upright ~ NPGO.3 + PDO.3 + CUTI_37.3, data = masterfile)

uind3.3.3 <- lm(upright ~ NPGO.3 + PDO.3 + BEUTI_37.3, data = masterfile)

uind3.4.3 <- lm(upright ~ NPGO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uind3.5.3 <- lm(upright ~ NPGO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uind3.6.3 <- lm(upright ~ NPGO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind3.7.3 <- lm(upright ~ PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uind3.8.3 <- lm(upright ~ PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uind3.9.3 <- lm(upright ~ PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind3.10.3 <- lm(upright ~ SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind2.1.3 <- lm(upright ~ NPGO.3 + PDO.3, data = masterfile)

uind2.2.3 <- lm(upright ~ NPGO.3 + SOI.3, data = masterfile)

uind2.3.3 <- lm(upright ~ NPGO.3 + CUTI_37.3, data = masterfile)

uind2.4.3 <- lm(upright ~ NPGO.3 + BEUTI_37.3, data = masterfile)

uind2.5.3 <- lm(upright ~ PDO.3 + SOI.3, data = masterfile)

uind2.6.3 <- lm(upright ~ PDO.3 + CUTI_37.3, data = masterfile)

uind2.7.3 <- lm(upright ~ PDO.3 + BEUTI_37.3, data = masterfile)

uind2.8.3 <- lm(upright ~ SOI.3 + CUTI_37.3, data = masterfile)

uind2.9.3 <- lm(upright ~ SOI.3 + BEUTI_37.3, data = masterfile)

uind2.10.3 <- lm(upright ~ CUTI_37.3 + BEUTI_37.3, data = masterfile)

uind1.1.3 <- lm(upright ~ NPGO.3, data = masterfile)

uind1.2.3 <- lm(upright ~ PDO.3, data = masterfile)

uind1.3.3 <- lm(upright ~ SOI.3, data = masterfile)

uind1.4.3 <- lm(upright ~ CUTI_37.3, data = masterfile)

uind1.5.3 <- lm(upright ~ BEUTI_37.3, data = masterfile)

#define list of models
uindmodels3 <- list(uind5.1.3, uind4.1.3, uind4.2.3, uind4.3.3, uind4.4.3, uind4.5.3, uind3.1.3, uind3.2.3, uind3.3.3, uind3.4.3, uind3.5.3, uind3.6.3, uind3.7.3, uind3.8.3, uind3.9.3, uind3.10.3, uind2.1.3, uind2.2.3, uind2.3.3, uind2.4.3, uind2.5.3, uind2.6.3, uind2.7.3, uind2.8.3, uind2.9.3, uind2.10.3, uind1.1.3, uind1.2.3, uind1.3.3, uind1.4.3, uind1.5.3)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
uindmod3.names <- c('uind5.1.3', 'uind4.1.3', 'uind4.2.3', 'uind4.3.3', 'uind4.4.3', 'uind4.5.3', 'uind3.1.3', 'uind3.2.3', 'uind3.3.3', 'uind3.4.3', 'uind3.5.3', 'uind3.6.3', 'uind3.7.3', 'uind3.8.3', 'uind3.9.3', 'uind3.10.3', 'uind2.1.3', 'uind2.2.3', 'uind2.3.3', 'uind2.4.3', 'uind2.5.3', 'uind2.6.3', 'uind2.7.3', 'uind2.8.3', 'uind2.9.3', 'uind2.10.3', 'uind1.1.3', 'uind1.2.3', 'uind1.3.3', 'uind1.4.3', 'uind1.5.3')

#calculate AIC of each model
uindmodel3_aic <- aictab(cand.set = uindmodels3, modnames = uindmod3.names)
```

Save AICc results as a CSV
```{r}
write.csv(uindmodel3_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/uindmodel3_aic.csv", row.names = TRUE)
```

Make a nice table of Upright model AIC rank results
```{r}
uindmodel3_table <-
  tab_df(uindmodel3_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - all upright species. Climate indices lagged 3 months.",
         show.footnote = TRUE)

print(uindmodel3_table)
```

Model uind5.1.3 is ranked the highest.
uind5.1.3 <- lm(upright ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(uind5.1.3)
```
```{r}
uind5.1.3
```
```{r}
summary(uind5.1.3)
```

```{r}
anova(uind5.1.3)
```

```{r}
confint(uind5.1.3)
```

Table of model uind5.1.3 with standard error
```{r, echo=FALSE}
top_uindmodel3 <-
  tab_model(uind5.1.3,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Linear model for cover of all upright species. Climate indices lagged by 1 month",
  linebreak = TRUE,
  dv.labels = c("cover of all upright species"),
  #define row labels
  pred.labels = c(
    "North Pacific Gyre Oscillation (NPGO)",
    "Pacific Decadal Oscillation (PDO)",
    "Southern Oscillation Index (SOI)",
    "Coastal Upwelling Trasnport Index (CUTI)",
    "Biological Effective Upwelling Transport Index (BEUTI)"),
  CSS = css_theme("cells"))

print(top_uindmodel3)
```

#AIC - Q2, upright algae, one month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"u" stands for the models used for the "upright" list of species. "a" stands for algae. ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "ua3.2.1" is the second list from the 3 values list, with a one month lag.
uaind5.1.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind4.1.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uaind4.2.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uaind4.3.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind4.4.1 <- lm(upalgae ~ NPGO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind4.5.1 <- lm(upalgae ~ PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind3.1.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + SOI.1, data = masterfile)

uaind3.2.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + CUTI_37.1, data = masterfile)

uaind3.3.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + BEUTI_37.1, data = masterfile)

uaind3.4.1 <- lm(upalgae ~ NPGO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uaind3.5.1 <- lm(upalgae ~ NPGO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uaind3.6.1 <- lm(upalgae ~ NPGO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind3.7.1 <- lm(upalgae ~ PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uaind3.8.1 <- lm(upalgae ~ PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uaind3.9.1 <- lm(upalgae ~ PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind3.10.1 <- lm(upalgae ~ SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind2.1.1 <- lm(upalgae ~ NPGO.1 + PDO.1, data = masterfile)

uaind2.2.1 <- lm(upalgae ~ NPGO.1 + SOI.1, data = masterfile)

uaind2.3.1 <- lm(upalgae ~ NPGO.1 + CUTI_37.1, data = masterfile)

uaind2.4.1 <- lm(upalgae ~ NPGO.1 + BEUTI_37.1, data = masterfile)

uaind2.5.1 <- lm(upalgae ~ PDO.1 + SOI.1, data = masterfile)

uaind2.6.1 <- lm(upalgae ~ PDO.1 + CUTI_37.1, data = masterfile)

uaind2.7.1 <- lm(upalgae ~ PDO.1 + BEUTI_37.1, data = masterfile)

uaind2.8.1 <- lm(upalgae ~ SOI.1 + CUTI_37.1, data = masterfile)

uaind2.9.1 <- lm(upalgae ~ SOI.1 + BEUTI_37.1, data = masterfile)

uaind2.10.1 <- lm(upalgae ~ CUTI_37.1 + BEUTI_37.1, data = masterfile)

uaind1.1.1 <- lm(upalgae ~ NPGO.1, data = masterfile)

uaind1.2.1 <- lm(upalgae ~ PDO.1, data = masterfile)

uaind1.3.1 <- lm(upalgae ~ SOI.1, data = masterfile)

uaind1.4.1 <- lm(upalgae ~ CUTI_37.1, data = masterfile)

uaind1.5.1 <- lm(upalgae ~ BEUTI_37.1, data = masterfile)

#define list of models
uaindmodels1 <- list(uaind5.1.1, uaind4.1.1, uaind4.2.1, uaind4.3.1, uaind4.4.1, uaind4.5.1, uaind3.1.1, uaind3.2.1, uaind3.3.1, uaind3.4.1, uaind3.5.1, uaind3.6.1, uaind3.7.1, uaind3.8.1, uaind3.9.1, uaind3.10.1, uaind2.1.1, uaind2.2.1, uaind2.3.1, uaind2.4.1, uaind2.5.1, uaind2.6.1, uaind2.7.1, uaind2.8.1, uaind2.9.1, uaind2.10.1, uaind1.1.1, uaind1.2.1, uaind1.3.1, uaind1.4.1, uaind1.5.1)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
uaindmod1.names <- c('NPGO + PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI + CUTI', 'NPGO + PDO + SOI + BEUTI', 'NPGO + PDO + CUTI + BEUTI', 'NPGO + SOI + CUTI + BEUTI', 'PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI', 'NPGO + PDO + CUTI', 'NPGO + PDO + BEUTI', 'NPGO + SOI + CUTI', 'NPGO + SOI + BEUTI', 'NPGO + CUTI + BEUTI', 'PDO + SOI + CUTI', 'PDO + SOI + BEUTI', 'PDO + CUTI + BEUTI', 'SOI + CUTI + BEUTI', 'NPGO + PDO', 'NPGO + SOI', 'NPGO + CUTI', 'NPGO + BEUTI', 'PDO + SOI', 'PDO + CUTI', 'PDO + BEUTI', 'SOI + CUTI', 'SOI + BEUTI', 'CUTI + BEUTI', 'NPGO', 'PDO', 'SOI', 'CUTI', 'BEUTI')

#calculate AIC of each model
uaindmodel1_aic <- aictab(cand.set = uaindmodels1, modnames = uaindmod1.names)

#Remove unnecessary column
uaindmodel1_aic <- select(uaindmodel1_aic, -ModelLik)

#Move LL column (log-likelihood) to end
uaindmodel1_aic <- uaindmodel1_aic %>% relocate (LL, .after = Cum.Wt)
```

Save AIC results as a CSV
```{r}
write.csv(uaindmodel1_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/uaindmodel1_aic.csv", row.names = TRUE)
```

Make a nice table of upalgae model AIC rank results
```{r}
uaindmodel1_table <-
  tab_df(uaindmodel1_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - Upright (non-crustose) algae species. Climate indices lagged 1 month.",
         col.header = c( #Default headers are okay, these are better
            "Model",
            "K",
            "AIC",
            "Delta AIC",
            "AIC Wt",
            "Cum. Wt",
            "LL"),
            CSS = list( #Use CSS to modify table appearance
           css.footnote = 'text-align: left; ',
         footnote = "<i>K</i> = multiplier penalty term depending on the number of terms in the model.<br/>
          <i>AIC</i> = Aikaki Information Criterion (AIC); models with lower AIC values contain more information.<br/>
         <i>Delta AIC</i> = Change in AIC value from top ranked model.<br/>
         <i>AIC Wt</i> = weight of evidence for given model.</br>
         <i>Cum.Wt</i> = cumulative AIC weight.</br>
         <i>LL</i> = log-likelihood of given model."),
         show.footnote = TRUE)

print(uaindmodel1_table)
```

Model uaind4.3.1 is ranked the highest.
uaind4.3.1 <- lm(upalgae ~ NPGO.1 + PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(uaind4.3.1)
```
```{r}
uaind4.3.1
```
```{r}
summary(uaind4.3.1)
```

```{r}
anova(uaind4.3.1)
```

```{r}
confint(uaind4.3.1)
```
NPGO.1 + PDO.1 + CUTI_37.1 + BEUTI_37.1
Table of model uaind4.3.1 with standard error
```{r, echo=FALSE}
top_uaindmodel1 <-
  tab_model(uaind4.3.1,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Top ranked linear model for large-scale ocean-climate patterns on cover of upright (non-crustose) algae species.",
  linebreak = TRUE,
  dv.labels = c("Cover"),
  #define row labels
  pred.labels = c(
    "Intercept",
    "NPGO",
    "PDO",
    "CUTI",
    "BEUTI"),
  CSS = css_theme("cells"))

print(top_uaindmodel1)
```

#AIC - Q2, upright algae, three month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"u" stands for the models used for the "upright" list of species. "a" stands for algae. ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "ua3.2.3" is the second list from the 3 values list, with a three month lag.
uaind5.1.3 <- lm(upalgae ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind4.1.3 <- lm(upalgae ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uaind4.2.3 <- lm(upalgae ~ NPGO.3 + PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uaind4.3.3 <- lm(upalgae ~ NPGO.3 + PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind4.4.3 <- lm(upalgae ~ NPGO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind4.5.3 <- lm(upalgae ~ PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind3.1.3 <- lm(upalgae ~ NPGO.3 + PDO.3 + SOI.3, data = masterfile)

uaind3.2.3 <- lm(upalgae ~ NPGO.3 + PDO.3 + CUTI_37.3, data = masterfile)

uaind3.3.3 <- lm(upalgae ~ NPGO.3 + PDO.3 + BEUTI_37.3, data = masterfile)

uaind3.4.3 <- lm(upalgae ~ NPGO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uaind3.5.3 <- lm(upalgae ~ NPGO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uaind3.6.3 <- lm(upalgae ~ NPGO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind3.7.3 <- lm(upalgae ~ PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uaind3.8.3 <- lm(upalgae ~ PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uaind3.9.3 <- lm(upalgae ~ PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind3.10.3 <- lm(upalgae ~ SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind2.1.3 <- lm(upalgae ~ NPGO.3 + PDO.3, data = masterfile)

uaind2.2.3 <- lm(upalgae ~ NPGO.3 + SOI.3, data = masterfile)

uaind2.3.3 <- lm(upalgae ~ NPGO.3 + CUTI_37.3, data = masterfile)

uaind2.4.3 <- lm(upalgae ~ NPGO.3 + BEUTI_37.3, data = masterfile)

uaind2.5.3 <- lm(upalgae ~ PDO.3 + SOI.3, data = masterfile)

uaind2.6.3 <- lm(upalgae ~ PDO.3 + CUTI_37.3, data = masterfile)

uaind2.7.3 <- lm(upalgae ~ PDO.3 + BEUTI_37.3, data = masterfile)

uaind2.8.3 <- lm(upalgae ~ SOI.3 + CUTI_37.3, data = masterfile)

uaind2.9.3 <- lm(upalgae ~ SOI.3 + BEUTI_37.3, data = masterfile)

uaind2.10.3 <- lm(upalgae ~ CUTI_37.3 + BEUTI_37.3, data = masterfile)

uaind1.1.3 <- lm(upalgae ~ NPGO.3, data = masterfile)

uaind1.2.3 <- lm(upalgae ~ PDO.3, data = masterfile)

uaind1.3.3 <- lm(upalgae ~ SOI.3, data = masterfile)

uaind1.4.3 <- lm(upalgae ~ CUTI_37.3, data = masterfile)

uaind1.5.3 <- lm(upalgae ~ BEUTI_37.3, data = masterfile)

#define list of models
uaindmodels3 <- list(uaind5.1.3, uaind4.1.3, uaind4.2.3, uaind4.3.3, uaind4.4.3, uaind4.5.3, uaind3.1.3, uaind3.2.3, uaind3.3.3, uaind3.4.3, uaind3.5.3, uaind3.6.3, uaind3.7.3, uaind3.8.3, uaind3.9.3, uaind3.10.3, uaind2.1.3, uaind2.2.3, uaind2.3.3, uaind2.4.3, uaind2.5.3, uaind2.6.3, uaind2.7.3, uaind2.8.3, uaind2.9.3, uaind2.10.3, uaind1.1.3, uaind1.2.3, uaind1.3.3, uaind1.4.3, uaind1.5.3)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
uaindmod3.names <- c('uaind5.1.3', 'uaind4.1.3', 'uaind4.2.3', 'uaind4.3.3', 'uaind4.4.3', 'uaind4.5.3', 'uaind3.1.3', 'uaind3.2.3', 'uaind3.3.3', 'uaind3.4.3', 'uaind3.5.3', 'uaind3.6.3', 'uaind3.7.3', 'uaind3.8.3', 'uaind3.9.3', 'uaind3.10.3', 'uaind2.1.3', 'uaind2.2.3', 'uaind2.3.3', 'uaind2.4.3', 'uaind2.5.3', 'uaind2.6.3', 'uaind2.7.3', 'uaind2.8.3', 'uaind2.9.3', 'uaind2.10.3', 'uaind1.1.3', 'uaind1.2.3', 'uaind1.3.3', 'uaind1.4.3', 'uaind1.5.3')

#calculate AIC of each model
uaindmodel3_aic <- aictab(cand.set = uaindmodels3, modnames = uaindmod3.names)
```

Save AICc results as a CSV
```{r}
write.csv(uaindmodel3_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/uaindmodel3_aic.csv", row.names = TRUE)
```

Make a nice table of upalgae model AIC rank results
```{r}
uaindmodel3_table <-
  tab_df(uaindmodel3_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - Upright (non-crustose) algae species. Climate indices lagged 3 months.",
         show.footnote = TRUE)

print(uaindmodel3_table)
```

Model uaind4.4.3 is ranked the highest.
uaind4.4.3 <- lm(upalgae ~ NPGO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(uaind4.4.3)
```
```{r}
uaind4.4.3
```
```{r}
summary(uaind4.4.3)
```

```{r}
anova(uaind4.4.3)
```

```{r}
confint(uaind4.4.3)
```
NPGO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3
Table of model uaind4.4.3 with standard error
```{r, echo=FALSE}
top_uaindmodel3 <-
  tab_model(uaind4.4.3,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Linear model for cover of upright (non-crustose) algae species. Climate indices lagged by 3 months",
  linebreak = TRUE,
  dv.labels = c("upright (non-crustose) algae"),
  #define row labels
  pred.labels = c(
    "North Pacific Gyre Oscillation (NPGO)",
    "Southern Oscillation Index (SOI)",
    "Coastal Upwelling Trasnport Index (CUTI)",
    "Biological Effective Upwelling Transport Index (BEUTI)"),
  CSS = css_theme("cells"))

print(top_uaindmodel3)
```

#AIC - Q2, upright invertebrate, one month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"u" stands for the models used for the "upright" list of species. "i" stands for invertebrate. "ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "uiind3.2.1" is the second list from the 3 values list, with a one month lag.
uiind5.1.1 <- lm(upinverts ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile) 

uiind4.1.1 <- lm(upinverts ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uiind4.2.1 <- lm(upinverts ~ NPGO.1 + PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uiind4.3.1 <- lm(upinverts ~ NPGO.1 + PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uiind4.4.1 <- lm(upinverts ~ NPGO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uiind4.5.1 <- lm(upinverts ~ PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uiind3.1.1 <- lm(upinverts ~ NPGO.1 + PDO.1 + SOI.1, data = masterfile)

uiind3.2.1 <- lm(upinverts ~ NPGO.1 + PDO.1 + CUTI_37.1, data = masterfile)

uiind3.3.1 <- lm(upinverts ~ NPGO.1 + PDO.1 + BEUTI_37.1, data = masterfile)

uiind3.4.1 <- lm(upinverts ~ NPGO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uiind3.5.1 <- lm(upinverts ~ NPGO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uiind3.6.1 <- lm(upinverts ~ NPGO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uiind3.7.1 <- lm(upinverts ~ PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

uiind3.8.1 <- lm(upinverts ~ PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

uiind3.9.1 <- lm(upinverts ~ PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uiind3.10.1 <- lm(upinverts ~ SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

uiind2.1.1 <- lm(upinverts ~ NPGO.1 + PDO.1, data = masterfile)

uiind2.2.1 <- lm(upinverts ~ NPGO.1 + SOI.1, data = masterfile)

uiind2.3.1 <- lm(upinverts ~ NPGO.1 + CUTI_37.1, data = masterfile)

uiind2.4.1 <- lm(upinverts ~ NPGO.1 + BEUTI_37.1, data = masterfile)

uiind2.5.1 <- lm(upinverts ~ PDO.1 + SOI.1, data = masterfile)

uiind2.6.1 <- lm(upinverts ~ PDO.1 + CUTI_37.1, data = masterfile)

uiind2.7.1 <- lm(upinverts ~ PDO.1 + BEUTI_37.1, data = masterfile)

uiind2.8.1 <- lm(upinverts ~ SOI.1 + CUTI_37.1, data = masterfile)

uiind2.9.1 <- lm(upinverts ~ SOI.1 + BEUTI_37.1, data = masterfile)

uiind2.10.1 <- lm(upinverts ~ CUTI_37.1 + BEUTI_37.1, data = masterfile)

uiind1.1.1 <- lm(upinverts ~ NPGO.1, data = masterfile)

uiind1.2.1 <- lm(upinverts ~ PDO.1, data = masterfile)

uiind1.3.1 <- lm(upinverts ~ SOI.1, data = masterfile)

uiind1.4.1 <- lm(upinverts ~ CUTI_37.1, data = masterfile)

uiind1.5.1 <- lm(upinverts ~ BEUTI_37.1, data = masterfile)

#define list of models
uiindmodels1 <- list(uiind5.1.1, uiind4.1.1, uiind4.2.1, uiind4.3.1, uiind4.4.1, uiind4.5.1, uiind3.1.1, uiind3.2.1, uiind3.3.1, uiind3.4.1, uiind3.5.1, uiind3.6.1, uiind3.7.1, uiind3.8.1, uiind3.9.1, uiind3.10.1, uiind2.1.1, uiind2.2.1, uiind2.3.1, uiind2.4.1, uiind2.5.1, uiind2.6.1, uiind2.7.1, uiind2.8.1, uiind2.9.1, uiind2.10.1, uiind1.1.1, uiind1.2.1, uiind1.3.1, uiind1.4.1, uiind1.5.1)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
uiindmod1.names <- c('NPGO + PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI + CUTI', 'NPGO + PDO + SOI + BEUTI', 'NPGO + PDO + CUTI + BEUTI', 'NPGO + SOI + CUTI + BEUTI', 'PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI', 'NPGO + PDO + CUTI', 'NPGO + PDO + BEUTI', 'NPGO + SOI + CUTI', 'NPGO + SOI + BEUTI', 'NPGO + CUTI + BEUTI', 'PDO + SOI + CUTI', 'PDO + SOI + BEUTI', 'PDO + CUTI + BEUTI', 'SOI + CUTI + BEUTI', 'NPGO + PDO', 'NPGO + SOI', 'NPGO + CUTI', 'NPGO + BEUTI', 'PDO + SOI', 'PDO + CUTI', 'PDO + BEUTI', 'SOI + CUTI', 'SOI + BEUTI', 'CUTI + BEUTI', 'NPGO', 'PDO', 'SOI', 'CUTI', 'BEUTI')

#calculate AIC of each model
uiindmodel1_aic <- aictab(cand.set = uiindmodels1, modnames = uiindmod1.names)

#Remove unnecessary column
uiindmodel1_aic <- select(uiindmodel1_aic, -ModelLik)

#Move LL column (log-likelihood) to end
uiindmodel1_aic <- uiindmodel1_aic %>% relocate (LL, .after = Cum.Wt)
```

Save AICc results as a CSV
```{r}
write.csv(uiindmodel1_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/uiindmodel1_aic.csv", row.names = TRUE)
```

Make a nice table of upinvert model AIC rank results
```{r}
uiindmodel1_table <-
  tab_df(uiindmodel1_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - Upright (non-crustose) invertebrate species.",
         col.header = c( #Default headers are okay, these are better
            "Model",
            "K",
            "AIC",
            "Delta AIC",
            "AIC Wt",
            "Cum. Wt",
            "LL"),
            CSS = list( #Use CSS to modify table appearance
           css.footnote = 'text-align: left; ',
         footnote = "<i>K</i> = multiplier penalty term depending on the number of terms in the model.<br/>
          <i>AIC</i> = Aikaki Information Criterion (AIC); models with lower AIC values contain more information.<br/>
         <i>Delta AIC</i> = Change in AIC value from top ranked model.<br/>
         <i>AIC Wt</i> = weight of evidence for given model.</br>
         <i>Cum.Wt</i> = cumulative AIC weight.</br>
         <i>LL</i> = log-likelihood of given model."),
         show.footnote = TRUE)

print(uiindmodel1_table)
```

Model uiind1.3.1 is ranked the highest.
uiind1.3.1 <- lm(upinverts ~ SOI.1, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(uiind1.3.1)
```
```{r}
uiind1.3.1
```
```{r}
summary(uiind1.3.1)
```

```{r}
anova(uiind1.3.1)
```

```{r}
confint(uiind1.3.1)
```
NPGO.1 + PDO.1 + CUTI_37.1 + BEUTI_37.1
Table of model uiind1.3.1 with standard error
```{r, echo=FALSE}
top_uiindmodel1 <-
  tab_model(uiind1.3.1,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Top ranked linear model for large-scale ocean-climate patterns on cover of upright sessile invertebrate species.",
  linebreak = TRUE,
  dv.labels = c("Cover"),
  #define row labels
  pred.labels = c(
    "Intercept",
    "SOI"),
  CSS = css_theme("cells"))

print(top_uiindmodel1)
```
#AIC - Q2, upright invertebrate, three month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"u" stands for the models used for the "upright" list of species. "i" stands for invertebrate. "ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "uiind3.2.3" is the second list from the 3 values list, with a three month lag.
uiind5.1.3 <- lm(upinverts ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile) 

uiind4.1.3 <- lm(upinverts ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uiind4.2.3 <- lm(upinverts ~ NPGO.3 + PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uiind4.3.3 <- lm(upinverts ~ NPGO.3 + PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uiind4.4.3 <- lm(upinverts ~ NPGO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uiind4.5.3 <- lm(upinverts ~ PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uiind3.1.3 <- lm(upinverts ~ NPGO.3 + PDO.3 + SOI.3, data = masterfile)

uiind3.2.3 <- lm(upinverts ~ NPGO.3 + PDO.3 + CUTI_37.3, data = masterfile)

uiind3.3.3 <- lm(upinverts ~ NPGO.3 + PDO.3 + BEUTI_37.3, data = masterfile)

uiind3.4.3 <- lm(upinverts ~ NPGO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uiind3.5.3 <- lm(upinverts ~ NPGO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uiind3.6.3 <- lm(upinverts ~ NPGO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uiind3.7.3 <- lm(upinverts ~ PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

uiind3.8.3 <- lm(upinverts ~ PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

uiind3.9.3 <- lm(upinverts ~ PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uiind3.10.3 <- lm(upinverts ~ SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

uiind2.1.3 <- lm(upinverts ~ NPGO.3 + PDO.3, data = masterfile)

uiind2.2.3 <- lm(upinverts ~ NPGO.3 + SOI.3, data = masterfile)

uiind2.3.3 <- lm(upinverts ~ NPGO.3 + CUTI_37.3, data = masterfile)

uiind2.4.3 <- lm(upinverts ~ NPGO.3 + BEUTI_37.3, data = masterfile)

uiind2.5.3 <- lm(upinverts ~ PDO.3 + SOI.3, data = masterfile)

uiind2.6.3 <- lm(upinverts ~ PDO.3 + CUTI_37.3, data = masterfile)

uiind2.7.3 <- lm(upinverts ~ PDO.3 + BEUTI_37.3, data = masterfile)

uiind2.8.3 <- lm(upinverts ~ SOI.3 + CUTI_37.3, data = masterfile)

uiind2.9.3 <- lm(upinverts ~ SOI.3 + BEUTI_37.3, data = masterfile)

uiind2.10.3 <- lm(upinverts ~ CUTI_37.3 + BEUTI_37.3, data = masterfile)

uiind1.1.3 <- lm(upinverts ~ NPGO.3, data = masterfile)

uiind1.2.3 <- lm(upinverts ~ PDO.3, data = masterfile)

uiind1.3.3 <- lm(upinverts ~ SOI.3, data = masterfile)

uiind1.4.3 <- lm(upinverts ~ CUTI_37.3, data = masterfile)

uiind1.5.3 <- lm(upinverts ~ BEUTI_37.3, data = masterfile)

#define list of models
uiindmodel3 <- list(uiind5.1.3, uiind4.1.3, uiind4.2.3, uiind4.3.3, uiind4.4.3, uiind4.5.3, uiind3.1.3, uiind3.2.3, uiind3.3.3, uiind3.4.3, uiind3.5.3, uiind3.6.3, uiind3.7.3, uiind3.8.3, uiind3.9.3, uiind3.10.3, uiind2.1.3, uiind2.2.3, uiind2.3.3, uiind2.4.3, uiind2.5.3, uiind2.6.3, uiind2.7.3, uiind2.8.3, uiind2.9.3, uiind2.10.3, uiind1.1.3, uiind1.2.3, uiind1.3.3, uiind1.4.3, uiind1.5.3)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
uiindmod3.names <- c('uiind5.1.3', 'uiind4.1.3', 'uiind4.2.3', 'uiind4.3.3', 'uiind4.4.3', 'uiind4.5.3', 'uiind3.1.3', 'uiind3.2.3', 'uiind3.3.3', 'uiind3.4.3', 'uiind3.5.3', 'uiind3.6.3', 'uiind3.7.3', 'uiind3.8.3', 'uiind3.9.3', 'uiind3.10.3', 'uiind2.1.3', 'uiind2.2.3', 'uiind2.3.3', 'uiind2.4.3', 'uiind2.5.3', 'uiind2.6.3', 'uiind2.7.3', 'uiind2.8.3', 'uiind2.9.3', 'uiind2.10.3', 'uiind1.1.3', 'uiind1.2.3', 'uiind1.3.3', 'uiind1.4.3', 'uiind1.5.3')

#calculate AIC of each model
uiindmodel3_aic <- aictab(cand.set = uiindmodel3, modnames = uiindmod3.names)
```

Save AICc results as a CSV
```{r}
write.csv(uiindmodel3_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/uiindmodel3_aic.csv", row.names = TRUE)
```

Make a nice table of upinvert model AIC rank results
```{r}
uiindmodel3_table <-
  tab_df(uiindmodel3_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - Upright (non-crustose) invertebrate species. Climate indices lagged three months.",
         show.footnote = TRUE)

print(uiindmodel3_table)
```

Model uiind1.3.3 is ranked the highest.
uiind1.3.3 <- lm(upinverts ~ SOI.3, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(uiind1.3.3)
```
```{r}
uiind1.3.3
```
```{r}
summary(uiind1.3.3)
```

```{r}
anova(uiind1.3.3)
```

```{r}
confint(uiind1.3.3)
```

Table of model uiind1.3.3 with standard error
```{r, echo=FALSE}
top_uiindmodel3 <-
  tab_model(uiind1.3.3,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Linear model for cover of upright (non-crustose) algae species. Climate indices lagged by 3 months",
  linebreak = TRUE,
  dv.labels = c("upright (non-crustose) algae"),
  #define row labels
  pred.labels = c(
    "Intercept",
    "Southern Oscillation Index (SOI)"),
  CSS = css_theme("cells"))

print(top_uiindmodel3)
```

#AIC - Q2, crusting, one month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"c" stands for the models used for the "crusting" list of species."ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "u3.2.1" is the second list from the 3 values list, with a one month lag.
cind5.1.1 <- lm(crusting ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile) 

cind4.1.1 <- lm(crusting ~ NPGO.1 + PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

cind4.2.1 <- lm(crusting ~ NPGO.1 + PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

cind4.3.1 <- lm(crusting ~ NPGO.1 + PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

cind4.4.1 <- lm(crusting ~ NPGO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

cind4.5.1 <- lm(crusting ~ PDO.1 + SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

cind3.1.1 <- lm(crusting ~ NPGO.1 + PDO.1 + SOI.1, data = masterfile)

cind3.2.1 <- lm(crusting ~ NPGO.1 + PDO.1 + CUTI_37.1, data = masterfile)

cind3.3.1 <- lm(crusting ~ NPGO.1 + PDO.1 + BEUTI_37.1, data = masterfile)

cind3.4.1 <- lm(crusting ~ NPGO.1 + SOI.1 + CUTI_37.1, data = masterfile)

cind3.5.1 <- lm(crusting ~ NPGO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

cind3.6.1 <- lm(crusting ~ NPGO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

cind3.7.1 <- lm(crusting ~ PDO.1 + SOI.1 + CUTI_37.1, data = masterfile)

cind3.8.1 <- lm(crusting ~ PDO.1 + SOI.1 + BEUTI_37.1, data = masterfile)

cind3.9.1 <- lm(crusting ~ PDO.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

cind3.10.1 <- lm(crusting ~ SOI.1 + CUTI_37.1 + BEUTI_37.1, data = masterfile)

cind2.1.1 <- lm(crusting ~ NPGO.1 + PDO.1, data = masterfile)

cind2.2.1 <- lm(crusting ~ NPGO.1 + SOI.1, data = masterfile)

cind2.3.1 <- lm(crusting ~ NPGO.1 + CUTI_37.1, data = masterfile)

cind2.4.1 <- lm(crusting ~ NPGO.1 + BEUTI_37.1, data = masterfile)

cind2.5.1 <- lm(crusting ~ PDO.1 + SOI.1, data = masterfile)

cind2.6.1 <- lm(crusting ~ PDO.1 + CUTI_37.1, data = masterfile)

cind2.7.1 <- lm(crusting ~ PDO.1 + BEUTI_37.1, data = masterfile)

cind2.8.1 <- lm(crusting ~ SOI.1 + CUTI_37.1, data = masterfile)

cind2.9.1 <- lm(crusting ~ SOI.1 + BEUTI_37.1, data = masterfile)

cind2.10.1 <- lm(crusting ~ CUTI_37.1 + BEUTI_37.1, data = masterfile)

cind1.1.1 <- lm(crusting ~ NPGO.1, data = masterfile)

cind1.2.1 <- lm(crusting ~ PDO.1, data = masterfile)

cind1.3.1 <- lm(crusting ~ SOI.1, data = masterfile)

cind1.4.1 <- lm(crusting ~ CUTI_37.1, data = masterfile)

cind1.5.1 <- lm(crusting ~ BEUTI_37.1, data = masterfile)

#define list of models
cindmodels1 <- list(cind5.1.1, cind4.1.1, cind4.2.1, cind4.3.1, cind4.4.1, cind4.5.1, cind3.1.1, cind3.2.1, cind3.3.1, cind3.4.1, cind3.5.1, cind3.6.1, cind3.7.1, cind3.8.1, cind3.9.1, cind3.10.1, cind2.1.1, cind2.2.1, cind2.3.1, cind2.4.1, cind2.5.1, cind2.6.1, cind2.7.1, cind2.8.1, cind2.9.1, cind2.10.1, cind1.1.1, cind1.2.1, cind1.3.1, cind1.4.1, cind1.5.1)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
cindmod1.names <- c('cind5.1.1', 'cind4.1.1', 'cind4.2.1', 'cind4.3.1', 'cind4.4.1', 'cind4.5.1', 'cind3.1.1', 'cind3.2.1', 'cind3.3.1', 'cind3.4.1', 'cind3.5.1', 'cind3.6.1', 'cind3.7.1', 'cind3.8.1', 'cind3.9.1', 'cind3.10.1', 'cind2.1.1', 'cind2.2.1', 'cind2.3.1', 'cind2.4.1', 'cind2.5.1', 'cind2.6.1', 'cind2.7.1', 'cind2.8.1', 'cind2.9.1', 'cind2.10.1', 'cind1.1.1', 'cind1.2.1', 'cind1.3.1', 'cind1.4.1', 'cind1.5.1')

#calculate AIC of each model
cindmodel1_aic <- aictab(cand.set = cindmodels1, modnames = cindmod1.names)
```

Save AICc results as a CSV
```{r}
write.csv(cindmodel1_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/cindmodel1_aic.csv", row.names = TRUE)
```

Make a nice table of crusting model AIC rank results
```{r}
cindmodel1_table <-
  tab_df(cindmodel1_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - all crusting species. Climate indices lagged 1 month.",
         show.footnote = TRUE)

print(cindmodel1_table)
```

Model cind1.4.1 is ranked the highest.
cind1.4.1 <- lm(crusting ~ CUTI_37.1, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(cind1.4.1)
```
```{r}
cind1.4.1
```
```{r}
summary(cind1.4.1)
```

```{r}
anova(cind1.4.1)
```

```{r}
confint(cind1.4.1)
```
cind1.4.1 <- lm(crusting ~ CUTI_37.1, data = masterfile)
Table of model cind1.4.1 with standard error
```{r, echo=FALSE}
top_cindmodel1 <-
  tab_model(cind1.4.1,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Linear model for cover of all crusting species. Climate indices lagged by 1 month",
  linebreak = TRUE,
  dv.labels = c("cover of all crusting species"),
  #define row labels
  pred.labels = c(
    "Intercept",
    "Coastal Upwelling Trasnport Index (CUTI)"),
  CSS = css_theme("cells"))

print(top_cindmodel1)
```

#AIC - Q2, crusting, three month lag
This is to answer my second question climate patterns on cover.
2) Does cover respond to ocean climate patterns (NPGO, PDO, SOI, CUTI, BEUTI)?
```{r, echo=FALSE}
#Create models for AIC analysis from the lists above
#"c" stands for the models used for the "crusting" list of species."ind" stands for indices.
#Leftmost number of the decimal is the amount of variables in the list. The center number is the (arbitrary) position of the unique list from the chunk above. The rightmost number represents the one month lag. For example, "u3.2.3" is the second list from the 3 values list, with a three month lag.
cind5.1.3 <- lm(crusting ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile) 

cind4.1.3 <- lm(crusting ~ NPGO.3 + PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

cind4.2.3 <- lm(crusting ~ NPGO.3 + PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

cind4.3.3 <- lm(crusting ~ NPGO.3 + PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

cind4.4.3 <- lm(crusting ~ NPGO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

cind4.5.3 <- lm(crusting ~ PDO.3 + SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

cind3.1.3 <- lm(crusting ~ NPGO.3 + PDO.3 + SOI.3, data = masterfile)

cind3.2.3 <- lm(crusting ~ NPGO.3 + PDO.3 + CUTI_37.3, data = masterfile)

cind3.3.3 <- lm(crusting ~ NPGO.3 + PDO.3 + BEUTI_37.3, data = masterfile)

cind3.4.3 <- lm(crusting ~ NPGO.3 + SOI.3 + CUTI_37.3, data = masterfile)

cind3.5.3 <- lm(crusting ~ NPGO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

cind3.6.3 <- lm(crusting ~ NPGO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

cind3.7.3 <- lm(crusting ~ PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)

cind3.8.3 <- lm(crusting ~ PDO.3 + SOI.3 + BEUTI_37.3, data = masterfile)

cind3.9.3 <- lm(crusting ~ PDO.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

cind3.10.3 <- lm(crusting ~ SOI.3 + CUTI_37.3 + BEUTI_37.3, data = masterfile)

cind2.1.3 <- lm(crusting ~ NPGO.3 + PDO.3, data = masterfile)

cind2.2.3 <- lm(crusting ~ NPGO.3 + SOI.3, data = masterfile)

cind2.3.3 <- lm(crusting ~ NPGO.3 + CUTI_37.3, data = masterfile)

cind2.4.3 <- lm(crusting ~ NPGO.3 + BEUTI_37.3, data = masterfile)

cind2.5.3 <- lm(crusting ~ PDO.3 + SOI.3, data = masterfile)

cind2.6.3 <- lm(crusting ~ PDO.3 + CUTI_37.3, data = masterfile)

cind2.7.3 <- lm(crusting ~ PDO.3 + BEUTI_37.3, data = masterfile)

cind2.8.3 <- lm(crusting ~ SOI.3 + CUTI_37.3, data = masterfile)

cind2.9.3 <- lm(crusting ~ SOI.3 + BEUTI_37.3, data = masterfile)

cind2.10.3 <- lm(crusting ~ CUTI_37.3 + BEUTI_37.3, data = masterfile)

cind1.1.3 <- lm(crusting ~ NPGO.3, data = masterfile)

cind1.2.3 <- lm(crusting ~ PDO.3, data = masterfile)

cind1.3.3 <- lm(crusting ~ SOI.3, data = masterfile)

cind1.4.3 <- lm(crusting ~ CUTI_37.3, data = masterfile)

cind1.5.3 <- lm(crusting ~ BEUTI_37.3, data = masterfile)

#define list of models
cindmodels3 <- list(cind5.1.3, cind4.1.3, cind4.2.3, cind4.3.3, cind4.4.3, cind4.5.3, cind3.1.3, cind3.2.3, cind3.3.3, cind3.4.3, cind3.5.3, cind3.6.3, cind3.7.3, cind3.8.3, cind3.9.3, cind3.10.3, cind2.1.3, cind2.2.3, cind2.3.3, cind2.4.3, cind2.5.3, cind2.6.3, cind2.7.3, cind2.8.3, cind2.9.3, cind2.10.3, cind1.1.3, cind1.2.3, cind1.3.3, cind1.4.3, cind1.5.3)

#specify model names
#AIC table will give its own names to your models as a default. So define them to stay organized.
cindmod3.names <- c('NPGO + PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI + CUTI', 'NPGO + PDO + SOI + BEUTI', 'NPGO + PDO + CUTI + BEUTI', 'NPGO + SOI + CUTI + BEUTI', 'PDO + SOI + CUTI + BEUTI', 'NPGO + PDO + SOI', 'NPGO + PDO + CUTI', 'NPGO + PDO + BEUTI', 'NPGO + SOI + CUTI', 'NPGO + SOI + BEUTI', 'NPGO + CUTI + BEUTI', 'PDO + SOI + CUTI', 'PDO + SOI + BEUTI', 'PDO + CUTI + BEUTI', 'SOI + CUTI + BEUTI', 'NPGO + PDO', 'NPGO + SOI', 'NPGO + CUTI', 'NPGO + BEUTI', 'PDO + SOI', 'PDO + CUTI', 'PDO + BEUTI', 'SOI + CUTI', 'SOI.3 + BEUTI', 'CUTI + BEUTI', 'NPGO', 'PDO', 'SOI', 'CUTI', 'BEUTI')

#calculate AIC of each model
cindmodel3_aic <- aictab(cand.set = cindmodels3, modnames = cindmod3.names)
```

Save AICc results as a CSV
```{r}
write.csv(cindmodel3_aic, "C:/Users/Elizabeth Max/iCloudDrive/Thesis/Data/R/cindmodel3_aic.csv", row.names = TRUE)
```

Make a nice table of crusting model AIC rank results
```{r}
cindmodel3_table <-
  tab_df(cindmodel3_aic,  #models to table
         alternate.rows = TRUE,
         title = "AIC Model Ranking Results - all crusting species. Climate indices lagged 3 month.",
         show.footnote = TRUE)

print(cindmodel3_table)
```

Model cind3.7.3 is ranked the highest.
cind3.7.3 <- lm(crusting ~ PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)
Let's take a closer look.

Fitting and analyzing the top ranked model
```{r}
plot(cind3.7.3)
```
```{r}
cind3.7.3
```
```{r}
summary(cind3.7.3)
```

```{r}
anova(cind3.7.3)
```

```{r}
confint(cind3.7.3)
```
cind3.7.3 <- lm(crusting ~ PDO.3 + SOI.3 + CUTI_37.3, data = masterfile)
Table of model cind3.7.3 with standard error
```{r, echo=FALSE}
top_cindmodel3 <-
  tab_model(cind3.7.3,
  show.ci = 0.95, #show 95% confidence interval
  show.se = TRUE, #show standard error
  show.stat = FALSE,
  emph.p = TRUE, #bold 'significant' p values
  df.method = "kr",
  p.style = "numeric_stars",
  title = "Linear model for cover of all crusting species. Climate indices lagged by 3 months",
  linebreak = TRUE,
  dv.labels = c("cover of all crusting species"),
  #define row labels
  pred.labels = c(
    "Intercept",
    "Pacific Decadal Oscillation (PDO)",
    "Southern Oscillation Index (SOI)",
    "Coastal Upwelling Trasnport Index (CUTI)"),
  CSS = css_theme("cells"))

print(top_cindmodel3)
```